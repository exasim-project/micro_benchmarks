case:
    type: CaseOnDisk
    solver: pimpleFoam
    origin: basicSetupOBR 
    post_build:
      - shell: ${{yaml.location}}/scripts/getMesh.sh
      - controlDict:
           writeFormat: binary
           libs: ("libOGL.so")
           endTime: 50.0
variation:
  - operation: shell
    key: ${{yaml.location}}/scripts/concatenateDomainOBR.sh
    values: [-n1, -n2, -n3]
    post_build:
      - shell: rm -rf 0
      - shell: mv 0.orig 0/
    variation:
      - operation: fvSolution
        schema: "linear_solver/{solver}{preconditioner}{executor}"
        values:
          - set: solvers/U
            preconditioner: BJ
            solver: GKOBiCGStab
            forceHostBuffer: "true"
            maxIter: 2000
            verbose: 1
            ranksPerGPU: ${{env.NCPUS_PER_GPU}}
            executor: ${{env.GINKGO_EXECUTOR}}
          - set: solvers/p
            solver: GAMG
            smoother: GaussSeidel
            preconditioner: GaussSeidel
            executor: CPU
        variation:
          - operation: decomposePar
            schema: "decomposition_GPU/{method}_{numberSubDomains}"
            values:
              - method: simple
                numberSubDomains: ${{ 1 * ${{env.NGPUS}} * ${{env.NCPUS_PER_GPU}} }}
              - method: simple                                           
                numberSubDomains: ${{ 2 * ${{env.NGPUS}} * ${{env.NCPUS_PER_GPU}} }}
              - method: simple                                           
                numberSubDomains: ${{ 4 * ${{env.NGPUS}} * ${{env.NCPUS_PER_GPU}} }}
              - method: simple                                           
                numberSubDomains: ${{ 8 * ${{env.NGPUS}} * ${{env.NCPUS_PER_GPU}} }}
            parent:
              executor: ${{env.GINKGO_EXECUTOR}}
          - operation: decomposePar
            schema: "decomposition_CPU/{method}_{numberSubDomains}"
            values:
              - method: simple
                numberSubDomains: ${{ 1 * ${{env.NCPUS}} }}
              - method: simple
                numberSubDomains: ${{ 2 * ${{env.NCPUS}} }}
              - method: simple
                numberSubDomains: ${{ 4 * ${{env.NCPUS}} }}
              - method: simple
                numberSubDomains: ${{ 8 * ${{env.NCPUS}} }}
            parent:
              executor: CPU
